### Тестируем aiohttp с помощью простого чата
__Оглавление__
* *Введение*
* *Структура aiohttp*
* *Роуты*
* *Request, Response*
* *Midlewares*
* *Базы данных*
* *Шаблоны*
* *Сессии, авторизация*
* *Статика*
* *Выгрузка на Heroku*

---
__Введение__

Прошлой осенью мне удалось побывать на нескольких python митапах в Киеве. На одном из них выступал Николай Новик и рассказывал он о новом асинхронном фреймворке [aiohttp](http://aiohttp.readthedocs.org/en/stable/), работающем на библиотеке для асинхронных вызовов [asyncio](https://docs.python.org/3/library/asyncio.html) в 3 версии интерпретатора питона. Данный фреймворк заинтересовал меня тем, что он создавался core python разработчиками, в основном Андреем Светловым из Киева и позиционировался как концепт python фреймворка для веба. Сейчас имеется огромное количество разных фреймворков, в каждом из которых своя философия, синтаксис и реализация общих для веба шаблонов. Я надеюсь, что со временем, все это разнообразие будет на одной основе - aiohttp.

__Структура aiohttp__

Основой aiohttp является бесконечный loop, в котором крутятся handlers. Handler - так называемая сорутина, объект, который не блокирует ввод/вывод(I/O). Данный тип объектов появился в python 3.4 в библиотеке asyncio. Пока не произойдут все вычисления в данном объекте, он как бы засыпает, а в это время интерпретатор может обрабатывать другие объекты. Чтобы было понятно, наведу пример. Зачастую все задержки сервера происходят, когда он ожидает ответа от базы данных и пока этот ответ не придет и не обработается, другие объекты ждут своей очереди. В данном случае другие объекты будут обрабатываться, пока не придет ответ от базы. Но для реализации этого нужен асинхронный драйвер. На данный момент для aiohttp реализованы [ асинхронные драйвера и врапперы ]( https://github.com/aio-libs/ ) для большинства популярных баз данных ( [ postgresql ]( https://github.com/aio-libs/aiopg ), [ mysql ]( https://github.com/aio-libs/aiomysql ), [ redis ](https://github.com/aio-libs/aioredis)) Для mongodb есть [ Motor ]( http://motor.readthedocs.org/en/stable/ ), который я буду использовать в своем проекте 
